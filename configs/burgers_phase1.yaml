# Configuration for Phase 1 (Meta-learning) training - Burgers Equation
# This phase trains the hypernetwork to learn parameter-conditioned weights

dataset:
  equation: "burgers"
  data_dir: "./data_gen/dataset"
  seed: 0
  n_train: 10  # Few-shot training samples
  cache: true
  # Balanced splits: deterministic, equal-sized test sets (20 interp + 20 extrap = 40 total)
  balance: true
  n_each: 20
  balance_strategy: random
  diversify: false

model:
  hidden_dim: 50
  phase: "phase1"

training:
  epochs: 20000
  learning_rate: 0.00025
  batch_size: null
  optimizer: "adamw"
  checkpoint_interval: 1000
  # Optional explicit initial-condition loss for Burgers:
  # u(x,0) = A * sin(k*pi*x), where dataset params are [A, k, nu]
  # Leave at 0.0 to avoid double-counting if you're already fitting full-field data.
  ic_weight: 0.0

export:
  output_dir: "./outputs"
  save_plots: true
  plot_max_samples: 5

device: "cuda:0"
seed: 42


